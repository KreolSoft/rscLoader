//* rscLoader 0.02.78 | Copyright (c) 2014 Nikita "IgelHaut" Nitichevski | MIT License *//

(function(d,b){var c={stylesheet:{type:["css"],createNode:function(h){var g=b.createElement("link");g.href=h;g.type="text/css";g.rel="stylesheet";return g},addListener:function(g,h){h.timer=function(){var i=this;d.setTimeout(function(){for(var j=0;j<b.styleSheets.length;j++){if(b.styleSheets[j].href==i.src){i.ready=true;delete (i.timer);break}}if(!i.ready){i.timer()}},10)};h.timer()}},javascript:{type:["js"],createNode:function(h){var g=b.createElement("script");g.src=h;g.async=true;g.type="text/javascript";return g},addListener:function(g,h){g.onload=function(){h.ready=true};g.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){h.ready=true}}}},image:{type:["png","bmp","svg","gif","jpg","jpeg"],createNode:function(h){var g=b.createElement("img");g.src=h;g.style.display="none";g.style.width="0";g.style.height="0";return g},addListener:function(g,h){g.onload=function(){h.ready=true};g.onreadystatechange=function(){if(this.readyState=="complete"){h.ready=true}}}}};function f(){var g=b.getElementById("rscLoaderTarget");if(!g){var h=b.createElement("div");h.id="rscLoaderTarget";h.style.display="none";h.style.width="0";h.style.height="0";b.body.insertBefore(h,b.body.childNodes[0]);g=b.getElementById("rscLoaderTarget")}return g}var e=function(){var k=this;this.resources=[];var j=[];var h=null;function l(){h=d.setTimeout(function(){for(var m=0;m<j.length;m++){j[m].callback(k.stats(j[m].type),k.resources)}if(k.stats("all").ready<k.stats("all").overall){l()}else{d.clearTimeout(h);d.clearTimeout(i)}},50)}var i=null;function g(){i=d.setTimeout(function(){for(var m=0;m<k.resources.length;m++){k.resources[m].ready=true}},1000*60*3)}this.stats=function(o){var m={overall:0,ready:0,notready:0};for(var n=0;n<k.resources.length;n++){if(o!="all"&&o!=k.resources[n].type){continue}m.overall++;if(k.resources[n].ready){m.ready++}if(!k.resources[n].ready){m.notready++}}return m};this.load=function(p,n){if(!n||!c[n]){for(var m in c){if(a(p.substr(p.lastIndexOf(".")+1),c[m].type)){n=m;break}}if(!n){return}}k.resources.push({type:n,src:p,ready:false});if(!h){l();g()}var o=c[n].createNode(p);c[n].addListener(o,k.resources[(k.resources.length-1)]);setTimeout(function(){f().insertBefore(o,null)},0);return k};this.listen=function(m,n){j.push({type:m,callback:n});return k}};d.rscLoader=d._rscLoader=e;function a(h,j){for(var g=0;g<j.length;g++){if(j[g]==h){return true}}return false}})(window,document);
